<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thêm câu hỏi</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .nav-pills .nav-link.active {
            background-color: #0d6efd;
        }
        .question-card {
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .answer-option {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        .answer-option:hover {
            border-color: #0d6efd;
            box-shadow: 0 2px 4px rgba(13, 110, 253, 0.1);
        }
        .excel-upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .excel-upload-area:hover {
            border-color: #0d6efd;
            background-color: rgba(13, 110, 253, 0.05);
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card question-card">
                    <div class="card-header bg-white py-3">
                        <h4 class="mb-0">Thêm câu hỏi mới</h4>
                    </div>
                    <div class="card-body">
                        <!-- Navigation Pills -->
                        <ul class="nav nav-pills mb-4" id="questionTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="manual-tab" data-bs-toggle="pill" data-bs-target="#manual" type="button">
                                    <i class="fas fa-keyboard me-2"></i>Nhập tay
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="excel-tab" data-bs-toggle="pill" data-bs-target="#excel" type="button">
                                    <i class="fas fa-file-excel me-2"></i>Nhập bằng Excel
                                </button>
                            </li>
                        </ul>

                        <!-- Tab Content -->
                        <div class="tab-content" id="questionTabsContent">
                            <!-- Manual Input Tab -->
                            <div class="tab-pane fade show active" id="manual" role="tabpanel">
                                <form>
                                    <div class="mb-4">
                                        <label class="form-label">Dạng câu hỏi</label>
                                        <select class="form-select" id="questionType" onchange="toggleQuestionType()">
                                            <option value="single">Câu hỏi đơn</option>
                                            <option value="paragraph">Đoạn văn nhiều câu hỏi</option>
                                        </select>
                                    </div>

                                    <!-- Single Question Form -->
                                    <div id="singleQuestionForm">
                                        <div class="mb-4">
                                            <label class="form-label">Loại câu hỏi</label>
                                            <select class="form-select">
                                                <option>Đọc hiểu</option>
                                                <option>Điền từ</option>
                                                <option>Tìm từ đồng nghĩa</option>
                                            </select>
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Nội dung câu hỏi</label>
                                            <div class="mb-2">
                                                <input type="radio" name="singleContentType" value="text" checked onchange="toggleSingleContentType()"> Text
                                                <input type="radio" name="singleContentType" value="image" class="ms-3" onchange="toggleSingleContentType()"> Ảnh
                                            </div>
                                            <div id="singleQuestionText">
                                                <textarea class="form-control" rows="4" placeholder="Nhập nội dung câu hỏi..."></textarea>
                                            </div>
                                            <div id="singleQuestionImage" style="display:none;">
                                                <input type="file" accept="image/*" class="form-control" onchange="previewSingleImage(event)">
                                                <img id="singleImagePreview" src="" alt="Xem trước ảnh" style="max-width:200px; margin-top:10px; display:none;">
                                            </div>
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Đáp án</label>
                                            <div id="answerOptions">
                                                <div class="answer-option">
                                                    <div class="d-flex align-items-center mb-2">
                                                        <input type="radio" class="form-check-input me-2" name="correctAnswer" checked>
                                                        <input type="text" class="form-control" placeholder="Nhập đáp án...">
                                                        <button type="button" class="btn btn-outline-danger ms-2" onclick="removeAnswer(this)">
                                                            <i class="fas fa-times"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <button type="button" class="btn btn-outline-primary mt-2" onclick="addAnswer()">
                                                <i class="fas fa-plus me-2"></i>Thêm đáp án
                                            </button>
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Giải thích</label>
                                            <textarea class="form-control" rows="3" placeholder="Nhập giải thích cho đáp án..."></textarea>
                                        </div>
                                    </div>

                                    <!-- Paragraph with Multiple Questions Form -->
                                    <div id="paragraphQuestionForm" style="display:none;">
                                        <div class="mb-4">
                                            <label class="form-label">Đoạn văn</label>
                                            <textarea class="form-control" rows="4" placeholder="Nhập đoạn văn..."></textarea>
                                        </div>
                                        <div id="subQuestions">
                                            <!-- Sub-question items will be appended here -->
                                        </div>
                                        <button type="button" class="btn btn-outline-primary mt-2" onclick="addSubQuestion()">
                                            <i class="fas fa-plus me-2"></i>Thêm câu hỏi nhỏ
                                        </button>
                                    </div>

                                    <div class="d-flex justify-content-end gap-2">
                                        <button type="button" class="btn btn-secondary">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu câu hỏi</button>
                                    </div>
                                </form>
                            </div>

                            <!-- Excel Import Tab -->
                            <div class="tab-pane fade" id="excel" role="tabpanel">
                                <div class="excel-upload-area" onclick="document.getElementById('excelFile').click()">
                                    <i class="fas fa-file-excel fa-3x text-success mb-3"></i>
                                    <h5>Kéo thả file Excel vào đây hoặc click để chọn file</h5>
                                    <p class="text-muted">Hỗ trợ file .xlsx, .xls</p>
                                    <input type="file" id="excelFile" accept=".xlsx,.xls" class="d-none">
                                </div>

                                <div class="mt-4">
                                    <h5>Hướng dẫn nhập Excel:</h5>
                                    <ol class="text-muted">
                                        <li>Tải file mẫu Excel tại đây</li>
                                        <li>Điền thông tin câu hỏi theo mẫu</li>
                                        <li>Upload file Excel lên hệ thống</li>
                                        <li>Kiểm tra và xác nhận thông tin</li>
                                    </ol>
                                </div>

                                <div class="d-flex justify-content-end gap-2 mt-4">
                                    <button type="button" class="btn btn-secondary">Hủy</button>
                                    <button type="button" class="btn btn-success">
                                        <i class="fas fa-download me-2"></i>Tải file mẫu
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    
    <script>
        function addAnswer() {
            const answerOptions = document.getElementById('answerOptions');
            const newAnswer = document.createElement('div');
            newAnswer.className = 'answer-option';
            newAnswer.innerHTML = `
                <div class="d-flex align-items-center mb-2">
                    <input type="radio" class="form-check-input me-2" name="correctAnswer">
                    <input type="text" class="form-control" placeholder="Nhập đáp án...">
                    <button type="button" class="btn btn-outline-danger ms-2" onclick="removeAnswer(this)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            answerOptions.appendChild(newAnswer);
        }

        function removeAnswer(button) {
            button.closest('.answer-option').remove();
        }

        function toggleQuestionType() {
            const type = document.getElementById('questionType').value;
            document.getElementById('singleQuestionForm').style.display = type === 'single' ? '' : 'none';
            document.getElementById('paragraphQuestionForm').style.display = type === 'paragraph' ? '' : 'none';
        }

        function toggleSingleContentType() {
            const type = document.querySelector('input[name="singleContentType"]:checked').value;
            document.getElementById('singleQuestionText').style.display = type === 'text' ? '' : 'none';
            document.getElementById('singleQuestionImage').style.display = type === 'image' ? '' : 'none';
        }

        function previewSingleImage(event) {
            const img = document.getElementById('singleImagePreview');
            if (event.target.files && event.target.files[0]) {
                img.src = URL.createObjectURL(event.target.files[0]);
                img.style.display = 'block';
            } else {
                img.src = '';
                img.style.display = 'none';
            }
        }

        // Sub-question logic
        function addSubQuestion() {
            const subQuestions = document.getElementById('subQuestions');
            const idx = subQuestions.children.length;
            const subQ = document.createElement('div');
            subQ.className = 'card mb-3';
            subQ.innerHTML = `
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <strong>Câu hỏi nhỏ ${idx + 1}</strong>
                        <button type="button" class="btn btn-outline-danger btn-sm" onclick="this.closest('.card').remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="mb-2">
                        <input type="radio" name="subContentType${idx}" value="text" checked onchange="toggleSubContentType(${idx})"> Text
                        <input type="radio" name="subContentType${idx}" value="image" class="ms-3" onchange="toggleSubContentType(${idx})"> Ảnh
                    </div>
                    <div id="subQuestionText${idx}">
                        <input type="text" class="form-control" placeholder="Nhập nội dung câu hỏi nhỏ...">
                    </div>
                    <div id="subQuestionImage${idx}" style="display:none;">
                        <input type="file" accept="image/*" class="form-control" onchange="previewSubImage(event, ${idx})">
                        <img id="subImagePreview${idx}" src="" alt="Xem trước ảnh" style="max-width:200px; margin-top:10px; display:none;">
                    </div>
                    <div>
                        <label class="form-label">Đáp án</label>
                        <div class="sub-answer-options">
                            <div class="answer-option">
                                <div class="d-flex align-items-center mb-2">
                                    <input type="radio" class="form-check-input me-2" name="correctSubAnswer${idx}">
                                    <input type="text" class="form-control" placeholder="Nhập đáp án...">
                                    <button type="button" class="btn btn-outline-danger ms-2" onclick="this.closest('.answer-option').remove()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm mt-2" onclick="addSubAnswer(this, ${idx})">
                            <i class="fas fa-plus me-2"></i>Thêm đáp án
                        </button>
                    </div>
                </div>
            `;
            subQuestions.appendChild(subQ);
        }

        function toggleSubContentType(idx) {
            const type = document.querySelector(`input[name="subContentType${idx}"]:checked`).value;
            document.getElementById(`subQuestionText${idx}`).style.display = type === 'text' ? '' : 'none';
            document.getElementById(`subQuestionImage${idx}`).style.display = type === 'image' ? '' : 'none';
        }

        function previewSubImage(event, idx) {
            const img = document.getElementById(`subImagePreview${idx}`);
            if (event.target.files && event.target.files[0]) {
                img.src = URL.createObjectURL(event.target.files[0]);
                img.style.display = 'block';
            } else {
                img.src = '';
                img.style.display = 'none';
            }
        }

        function addSubAnswer(btn, idx) {
            const answerOptions = btn.parentElement.querySelector('.sub-answer-options');
            const newAnswer = document.createElement('div');
            newAnswer.className = 'answer-option';
            newAnswer.innerHTML = `
                <div class="d-flex align-items-center mb-2">
                    <input type="radio" class="form-check-input me-2" name="correctSubAnswer${idx}">
                    <input type="text" class="form-control" placeholder="Nhập đáp án...">
                    <button type="button" class="btn btn-outline-danger ms-2" onclick="this.closest('.answer-option').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            answerOptions.appendChild(newAnswer);
        }
    </script>
</body>
</html>
